<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chez Picard - Instruments de musique</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{ 
      font-family: "Montserrat", Arial, sans-serif; 
      background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
      margin: 0; padding: 0;
      color: #222;
    }
    header{
      background:#3156a3;
      color: #fff;
      padding: 30px 0 20px 0;
      text-align: center;
    }
    header h1{
     margin:0;
     font-size: 2.5em;
     letter-spacing: 2px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 40px;
      max-width: 1100px;
      margin: 40px auto;
      padding: 10px;
    }
    .produits, .panier{
      background: #fff;
      border-radius: 16px;
      padding: 30px;
      flex: 350px;
      min-width: 320px;
      max-width:480px;
    }
    .produits h2, .panier h2{
      margin-top:0;
      color: #3156a3;
    }
    .produit-card {
      display: flex;
      align-items: center;
      gap: 18px;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid #f0f0f0;
    }
    .produit-card:last-child {
      border-bottom: none;
    }
    .produit-img {
      width: 50px;
      height: 50px;
      background: #f3f6fb;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.1em;
      color: #3156a3;
    }
    .produit-img img {
      width: 50px;
      height: auto;
      object-fit: cover;
      border-radius: 10px;
      display: block;
    }

    .produit-info{
      flex:1;
    }
    .produit-info h3 {
      margin: 0 0 6px 0;
      font-size: 1.2em;
      font-weight: 700;
    }
    .produit-info p { 
      margin: 0 0 7px 0; 
    }
    .produit-info .prix {
      color: #3156a3;
      font-weight: 700;
      font-size: 1.1em;
    }
    .produit-info button {
      background: #3156a3;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 7px 18px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    .produit-info button:hover { 
      background: #203a6b; 
    }
    .panier table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    .panier th, .panier td {
      padding: 8px;
      text-align: center;
    }
    .panier th {
      background: #f3f6fb;
      color: #3156a3;
      font-weight: 700;
      border-bottom: 2px solid #e0eafc;
    }
    .panier td { 
      border-bottom: 1px solid #f0f0f0; 
    }
    .panier td:last-child { 
      border-bottom: none; 
    }
    .panier .qty-btn {
      background: #e0eafc;
      color: #3156a3;
      border: none;
      border-radius: 4px;
      padding: 2px 10px;
      font-size: 1em;
      margin: 0 3px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .panier .qty-btn:hover { 
      background: #cfdef3; 
    }
    .panier .remove-btn {
      background: none;
      border: none;
      color: #c0392b;
      font-size: 1.1em;
      cursor: pointer;
    }
    .panier-summary {
      font-size: 1.05em;
      margin-bottom: 15px;
    }
    .panier-summary span { 
      float: right; 
    }
    .panier .checkout-btn {
      width: 100%;
      background: #28a745;
      color: #fff;
      font-weight: 700;
      border: none;
      border-radius: 6px;
      padding: 12px 0;
      font-size: 1.1em;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.2s;
    }
    .panier .checkout-btn:hover { 
      background: #1e7e34; 
    }
    .reçu-model {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(49,86,163,0.07);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .reçu-model.active {
      display: flex;
    }
    .reçu-content {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(49,86,163,0.18);
      max-width: 400px;
      width: 95%;
      padding: 30px 24px 24px 24px;
      text-align: center;
      position: relative;
      animation: fadeIn 0.4s;
    }
    .reçu-content h2 {
      color: #28a745;
      margin-top: 0;
      font-size: 1.5em;
      margin-bottom: 18px;
    }
    .reçu-content table {
      width: 100%;
      margin-bottom: 15px;
      border-collapse: collapse;
      font-size: 1em;
    }
    .reçu-content th, .reçu-content td {
      padding: 6px 4px;
      border-bottom: 1px solid #e0eafc;
    }
    .reçu-content th {
      color: #3156a3;
      font-weight: 700;
      background: #f3f6fb;
    }
    .reçu-content .total-row td {
      font-weight: 700;
      color: #3156a3;
    }
    .reçu-content .close-btn {
      position: absolute;
      top: 10px; right: 16px;
      background: none;
      border: none;
      font-size: 1.5em;
      color: #aaa;
      cursor: pointer;
    }
    .reçu-content .close-btn:hover { 
      color: #3156a3; 
    }
    .reçu-content .print-btn {
      background: #3156a3;
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 7px 20px;
      font-size: 1em;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.2s;
    }
    .reçu-content .print-btn:hover { 
      background: #203a6b;
    }
    @media (max-width: 900px) {
      .container { 
        flex-direction: column; gap: 30px; 
      }
    }
    @media (max-width: 600px) {
      .produits, .panier { 
        padding: 18px; 
      }
      .reçu-content { 
        padding: 12px 6px 16px 6px; 
      }
    }
  </style>
</head>
<body>
  <header>
    <h1> Chez Picard</h1>
    <p> « Inspirer, jouez, partager »</p>
    <p> Nous sommes une compagnie pour but d'apporter de la joie musical à tous le monde!</p>
  </header>
  <div class="container">
    <section class="produits">
      <h2> Les instruments</h2>
      <div id="produitList"></div>
    </section>
    <section class="panier">
      <h2> Votre Panier</h2>
      <table id="panierTable">
        <thead>
          <tr>
            <th> Produit</th>
            <th> Prix</th>
            <th>Qté</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="panierItems"></tbody>
      </table>
      <div class="panier-summary">
        <div> Sous-total <span id="subtotal">$0.00</span></div>
        <div>Taxe (13%) <span id="gst">$0.00</span></div>
        <div>Livraison <span id="shipping">$0.00</span></div>
        <hr>
        <div style="font-size:1.15em;font-weight:700;">Total <span id="total">$0.00</span></div>
      </div>
      <button class="checkout-btn" onclick="generateReçu()" id="checkoutBtn" disabled>Passer la commande</button>
    </section>
  </div>
  
  <!-- Le model du reçu-->
  <div class="reçu-model" id="reçuModel">
    <div class="reçu-content" id="reçuContent">
     <button class="close-btn" onclick="closeReçu()">×</button>  
    </div>
  </div>
  
  <script>
    const produits = [
     {
      id: 1,
      name: "Guitare électrique", 
      price: 549.99,
      image: "https://cdn.shoplightspeed.com/shops/619825/files/9124993/768x768x2/yamaha-guitare-electrique-yamaha-pac012.jpg"
     },
     {
       id: 2,
       name: "Piano",
       price: 1499.99,
       image: "https://m.media-amazon.com/images/I/71FobkNjTZL.jpg"
     },
     { 
       id: 3,
       name: "Batterie acoustique",
       price: 899.99,
       image: "https://boutique.drummondmusique.com/cdn/shop/files/DrummondMusique_Pearl_RSJ465CC31_RoadshowJunior5morceauxavec-banc_baguettes_cymbalesetHardwareinclus_535x.jpg?v=1728400396"
     }
    ];   

    let panier = [];

    // Affiche la liste des produits (max 10 exemplaires par produit)
    function afficherProduits() {
      const conteneur = document.getElementById('produitList');
      conteneur.innerHTML = '';
      produits.forEach(produit => {
        const itemPanier = panier.find(item => item.id === produit.id);
        const quantite = itemPanier ? itemPanier.qty : 0;
        const boutonDesactive = quantite >= 10 ? 'disabled' : '';
        const carte = document.createElement('div');
        carte.className = 'produit-card';
        carte.innerHTML = `
          <div class="produit-img"><img src="${produit.image}" alt="${produit.name}"></div>
          <div class="produit-info">
            <h3>${produit.name}</h3>
            <div class="prix">Prix : $${produit.price.toFixed(2)}</div>
            <button onclick="ajouterAuPanier(${produit.id})" ${boutonDesactive}>Ajouter au panier</button>
          </div>
        `;
        conteneur.appendChild(carte);
      });
    }

    // Ajoute un produit au panier (max 10)
    function ajouterAuPanier(produitId) {
      let item = panier.find(p => p.id === produitId);
      if (item) {
        if (item.qty < 10) item.qty++;
      } else {
        let produit = produits.find(p => p.id === produitId);
        panier.push({ ...produit, qty: 1 });
      }
      afficherPanier();
      afficherProduits();
    }

    // Modifie la quantité d'un produit dans le panier
    function changerQuantite(produitId, delta) {
      let item = panier.find(p => p.id === produitId);
      if (!item) return;
      item.qty += delta;
      if (item.qty <= 0) {
        panier = panier.filter(p => p.id !== produitId);
      }
      if (item.qty > 10) item.qty = 10;
      afficherPanier();
      afficherProduits();
    }

    // Retire un produit du panier
    function retirerDuPanier(produitId) {
      panier = panier.filter(p => p.id !== produitId);
      afficherPanier();
      afficherProduits();
    }

    // Affiche le panier et les totaux
    function afficherPanier() {
      const tbody = document.getElementById('panierItems');
      tbody.innerHTML = '';
      let subtotal = 0;
      panier.forEach(item => {
        subtotal += item.price * item.qty;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.name}</td>
          <td>$${item.price.toFixed(2)}</td>
          <td>
            <button class="qty-btn" onclick="changerQuantite(${item.id}, -1)" ${item.qty <= 1 ? 'disabled' : ''}>-</button>
            ${item.qty}
            <button class="qty-btn" onclick="changerQuantite(${item.id}, 1)" ${item.qty >= 10 ? 'disabled' : ''}>+</button>
          </td>
          <td>
            <button class="remove-btn" onclick="retirerDuPanier(${item.id})" title="Retirer">🗑️</button>
          </td>
        `;
        tbody.appendChild(tr);
      });

      document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
      const gst = subtotal * 0.13;
      document.getElementById('gst').textContent = `$${gst.toFixed(2)}`;
      const shipping = subtotal > 0 ? 20 : 0;
      document.getElementById('shipping').textContent = `$${shipping.toFixed(2)}`;
      const total = subtotal + gst + shipping;
      document.getElementById('total').textContent = `$${total.toFixed(2)}`;
      document.getElementById('checkoutBtn').disabled = panier.length === 0;
    }

  // --- Génération du reçu ---
    function generateReçu() {
      if (panier.length === 0) return;
      let subtotal = 0, totalWeight = 0;
      panier.forEach(item => {
        subtotal += item.price * item.quantity;
        totalWeight += item.weight * item.quantity;
      });
      const gst = subtotal * 0.05;
      const qst = subtotal * 0.09975;
      const shipping = calculateShipping(totalWeight);
      const total = subtotal + gst + qst + shipping;

      const now = new Date();
      const dateStr = now.toLocaleDateString('fr-CA', { year: 'numeric', month: 'long', day: 'numeric' });
      const timeStr = now.toLocaleTimeString('fr-CA', { hour: '2-digit', minute: '2-digit' });

      const reçuHTML = `
        <h2>Reçu de commande</h2>
        <div style="color:#777;margin-bottom:15px;">${dateStr} à ${timeStr}</div>
        <table>
          <thead>
            <tr><th>Produit</th><th>Qté</th><th>Total</th></tr>
          </thead>
          <tbody>
            ${cart.map(item => `
              <tr>
                <td>${item.name}</td>
                <td>${item.quantity}</td>
                <td>$${(item.price * item.quantity).toFixed(2)}</td>
              </tr>
            `).join('')}
          </tbody>
        </table>
        <div style="text-align:left;margin:18px 0 0 0;">
          <div>Sous-total : <span style="float:right;">$${subtotal.toFixed(2)}</span></div>
          <div>TPS (5%) : <span style="float:right;">$${gst.toFixed(2)}</span></div>
          <div>TVQ (9.975%) : <span style="float:right;">$${qst.toFixed(2)}</span></div>
          <div>Livraison : <span style="float:right;">$${shipping.toFixed(2)}</span></div>
          <hr>
          <div style="font-size:1.15em;font-weight:700;">Total : <span style="float:right;">$${total.toFixed(2)} CAD</span></div>
        </div>
        <div style="margin-top:22px;color:#28a745;font-weight:700;">Merci pour votre achat chez chez Picard!</div>
        <button class="print-btn" onclick="window.print()">Imprimer le reçu</button>
      `;
      document.getElementById('receiptContent').innerHTML = receiptHTML + `<button class="close-btn" onclick="closeReceipt()">&times;</button>`;
      document.getElementById('receiptModel').style.display = 'flex';

      //Panier redémarre après l’achat
      panier = [];
      updatePanier();
    }
    function closeReçu() {
      document.getElementById('reçuModel').style.display = 'none';
    }

    // Initialisation
    afficherProduits();
    afficherPanier();
    
  </script>
</body>
</html>
